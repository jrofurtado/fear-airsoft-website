// Auto-generated from index.html.
// DO NOT EDIT.

library model;

import 'dart:html' as autogenerated;
import 'dart:svg' as autogenerated_svg;
import 'package:web_ui/web_ui.dart' as autogenerated;
import 'dart:html';
import 'dart:json';
import 'dart:async';
import 'package:web_ui/web_ui.dart';
import 'package:js/js.dart' as js;
import 'package:web_ui/watcher.dart' as watchers;
import 'x-siteheader.dart';
import 'x-sitenavigation.dart';
import 'x-pagina-clube.dart';
import 'x-pagina-anuncios.dart';
import 'x-pagina-jogos.html.dart';
import 'x-pagina-membros.dart';
import 'x-pagina-equipas.html.dart';
import 'x-pagina-galeria.dart';
import 'x-pagina-forum.html.dart';
import 'x-pagina-inscricoes.html.dart';
import 'x-pagina-documentos.html.dart';
import 'x-pagina-contas.dart';
import 'x-sitefooter.dart';


// Original code


class Model{
  static final String endpoint_imagens = "https://www.googledrive.com/host/0B4Nj2G61OMg-NXI4c3dyLU4wVzA/";
  static final String endpoint_json ="http://json.fear-airsoft.com/json/";
  
  Collection<NavLink> navlinks = [
                         NavLink.Clube,
                         NavLink.Anuncios,
                         NavLink.Jogos,
                         NavLink.Membros,
                         NavLink.Equipas,
                         NavLink.Galeria,
                         NavLink.Forum,
                         NavLink.Inscricoes,
                         NavLink.Documentos,
                         NavLink.Contas
                         ];
  String hash = window.location.hash;
  String href = window.location.href;
  String mainPage = window.location.protocol.concat("//").concat(window.location.host).concat(window.location.pathname);
  String emblemaSeleccionado;
  List<Map> _tempo;
  List<Map> get tempo {
    if(jogo.length==0){
      return [];
    } else {
      if(_tempo==null){
        _tempo=[];
        String mes = "0${jogo[0]['mes']}";
        mes = mes.substring(mes.length-2, mes.length);
        String dia = "0${jogo[0]['dia']}";
        dia = dia.substring(dia.length-2, dia.length);
        String data = "${jogo[0]['ano']}-${mes}-${dia}";
        HttpRequest.request("${endpoint_json}tempo?lat=${jogo[0]['campo']['lat']}&lng=${jogo[0]['campo']['lng']}&data=${data}").then((req){model._tempo=parse(req.responseText);watchers.dispatch();});
      }
      return _tempo;
    }
  }
  List<Map> _membros;
  List<Map> get membros {
    if(_membros==null){
      _membros=[];
      HttpRequest.request("${endpoint_json}publishedData/membros").then((req){model._membros=parse(req.responseText);watchers.dispatch();});
    }
    return _membros;
  }
  List<List> _equipes;
  List<List> get equipes {
    if(equipes==null){
      _equipes=[];
      HttpRequest.request("${endpoint_json}publishedData/equipes").then((req){model._equipes=parse(req.responseText);watchers.dispatch();});
    }
    return _equipes;
  }
  Map _emblemas;
  Map get emblemas {
    if(_emblemas==null){
      _emblemas={"emblemas":[],"patentes":[]};
      HttpRequest.request("${endpoint_json}publishedData/emblemas").then((req){model._emblemas=parse(req.responseText);watchers.dispatch();});
    }
    return _emblemas;
  }
  List<Map> _galeria;
  List<Map> get galeria {
    if(_galeria==null){
      _galeria=[];
      HttpRequest.request("${endpoint_json}publishedData/galeria").then((req){model._galeria=parse(req.responseText);watchers.dispatch();});
    }
    return _galeria;
  }
  List<Map> _anuncios;
  List<Map> get anuncios {
    if(_anuncios==null){
      _anuncios=[];
      HttpRequest.request("${endpoint_json}publishedData/anuncios").then((req){model._anuncios=parse(req.responseText);watchers.dispatch();});
    }
    return _anuncios;
  }
  List<Map> _campos;
  List<Map> get campos {
    if(_campos==null){
      _campos=[];
      HttpRequest.request("${endpoint_json}publishedData/campos").then((req){model._campos=parse(req.responseText);watchers.dispatch();});
    }
    return _campos;
  }
  List<Map> _jogo;
  List<Map> get jogo {
    if(_jogo==null){
      _jogo=[];
      HttpRequest.request("${endpoint_json}publishedData/jogo").then((req){
        List<Map> tmpJogo =parse(req.responseText);
        if(tmpJogo.length>0 && !dataFimJogo(tmpJogo[0]).isBefore(new DateTime.now())){
          model._jogo = tmpJogo;
          watchers.dispatch();
        }
      });
    }
    return _jogo;
  }

  DateTime dataFimJogo(Map jogo) {
    return new DateTime(jogo['ano'],jogo['mes'],jogo['dia'],jogo['horaFim'],jogo['minutosFim'],0);
  }

  changePage(String link) {    
    model.mainPage=window.location.protocol.concat("//").concat(window.location.host).concat(window.location.pathname);
    model.href=mainPage.concat(link);
    model.hash=link;
  }
}

Model model = new Model();

class NavLink {
  static final NavLink Clube = new NavLink("Clube","#/clube");
  static final NavLink Anuncios = new NavLink("Anuncios","#/anuncios");
  static final NavLink Jogos = new NavLink("Jogos", "#/jogos");
  static final NavLink Membros = new NavLink("Membros", "#/membros");
  static final NavLink Equipas = new NavLink("Equipas", "#/equipas");
  static final NavLink Galeria = new NavLink("Galeria", "#/galeria");
  static final NavLink Forum = new NavLink("Fórum", "#/forum.html");
  static final NavLink Inscricoes = new NavLink("Inscrições", "#/inscricoes");
  static final NavLink Documentos = new NavLink("Links", "#/documentos");
  static final NavLink Contas = new NavLink("Contas", "#/contas");
  String name;
  String link;
  
  NavLink(this.name, this.link);
}

void main() {
//  useShadowDom = true; // to enable use of experimental Shadow DOM in the browser
  updateFilters(e) {
    model.mainPage=window.location.protocol.concat("//").concat(window.location.host).concat(window.location.pathname);    
    model.hash=window.location.hash;
    model.href=window.location.href;
    watchers.dispatch();
  }
  window.onHashChange.listen(updateFilters);
  window.onPopState.listen(updateFilters);
}

// Additional generated code
void init_autogenerated() {
  var _root = autogenerated.document.body;
  var __e0, __e1, __e11, __e13, __e15, __e17, __e19, __e21, __e22, __e3, __e5, __e7, __e9;
  var __t = new autogenerated.Template(_root);
  __e0 = _root.query('#__e-0');
  new SiteHeader.forElement(__e0);
  __t.component(__e0);
  __e1 = _root.query('#__e-1');
  new SiteNavigation.forElement(__e1);
  __t.component(__e1);
  __e3 = _root.query('#__e-3');
  __t.conditional(__e3, () => model.hash==''||model.hash.startsWith(NavLink.Clube.link), (__t) {
    var __e2;
    __e2 = new autogenerated.Element.tag('x-pagina-clube');
    new PaginaClube.forElement(__e2);
    __t.component(__e2);
  __t.add(__e2);
  });

  __e5 = _root.query('#__e-5');
  __t.conditional(__e5, () => model.hash.startsWith(NavLink.Anuncios.link), (__t) {
    var __e4;
    __e4 = new autogenerated.Element.tag('x-pagina-anuncios');
    new PaginaAnuncios.forElement(__e4);
    __t.component(__e4);
  __t.add(__e4);
  });

  __e7 = _root.query('#__e-7');
  __t.conditional(__e7, () => model.hash.startsWith(NavLink.Jogos.link), (__t) {
    var __e6;
    __e6 = new autogenerated.Element.tag('x-pagina-jogos');
    new PaginaJogos.forElement(__e6);
    __t.component(__e6);
  __t.add(__e6);
  });

  __e9 = _root.query('#__e-9');
  __t.conditional(__e9, () => model.hash.startsWith(NavLink.Membros.link), (__t) {
    var __e8;
    __e8 = new autogenerated.Element.tag('x-pagina-membros');
    new PaginaMembros.forElement(__e8);
    __t.component(__e8);
  __t.add(__e8);
  });

  __e11 = _root.query('#__e-11');
  __t.conditional(__e11, () => model.hash.startsWith(NavLink.Equipas.link), (__t) {
    var __e10;
    __e10 = new autogenerated.Element.tag('x-pagina-equipas');
    new PaginaEquipas.forElement(__e10);
    __t.component(__e10);
  __t.add(__e10);
  });

  __e13 = _root.query('#__e-13');
  __t.conditional(__e13, () => model.hash.startsWith(NavLink.Galeria.link), (__t) {
    var __e12;
    __e12 = new autogenerated.Element.tag('x-pagina-galeria');
    new PaginaGaleria.forElement(__e12);
    __t.component(__e12);
  __t.add(__e12);
  });

  __e15 = _root.query('#__e-15');
  __t.conditional(__e15, () => model.hash.startsWith(NavLink.Forum.link), (__t) {
    var __e14;
    __e14 = new autogenerated.Element.tag('x-pagina-forum');
    new PaginaForum.forElement(__e14);
    __t.component(__e14);
  __t.add(__e14);
  });

  __e17 = _root.query('#__e-17');
  __t.conditional(__e17, () => model.hash.startsWith(NavLink.Inscricoes.link), (__t) {
    var __e16;
    __e16 = new autogenerated.Element.tag('x-pagina-inscricoes');
    new PaginaInscricoes.forElement(__e16);
    __t.component(__e16);
  __t.add(__e16);
  });

  __e19 = _root.query('#__e-19');
  __t.conditional(__e19, () => model.hash.startsWith(NavLink.Documentos.link), (__t) {
    var __e18;
    __e18 = new autogenerated.Element.tag('x-pagina-documentos');
    new PaginaDocumentos.forElement(__e18);
    __t.component(__e18);
  __t.add(__e18);
  });

  __e21 = _root.query('#__e-21');
  __t.conditional(__e21, () => model.hash.startsWith(NavLink.Contas.link), (__t) {
    var __e20;
    __e20 = new autogenerated.Element.tag('x-pagina-contas');
    new PaginaContas.forElement(__e20);
    __t.component(__e20);
  __t.add(__e20);
  });

  __e22 = _root.query('#__e-22');
  new SiteFooter.forElement(__e22);
  __t.component(__e22);
  __t.create();
  __t.insert();
}

//@ sourceMappingURL=model.dart.map